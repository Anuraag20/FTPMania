import{useState as x,useRef as t,useCallback as V,useEffect as h,useLayoutEffect as w}from"react";var u=typeof window=="undefined"?h:w,C=({isPlaying:m,duration:e,onComplete:b,autoResetKey:S,startAt:i=0})=>{let[p,q]=x(i),y=t(i*-1e3),r=t(null),c=t(null),a=t(null),s=t(!1),f=t(!1),F=t(0),T=V(n=>{F.current+=1,q(typeof n=="number"?n:i)},[]),o=n=>{let l=n/1e3;if(c.current===null){c.current=l,r.current=requestAnimationFrame(o);return}let d=l-c.current;c.current=l,q(E=>{let A=E+d;return typeof e!="number"||A<e?A:(f.current=!0,e)}),f.current||(r.current=requestAnimationFrame(o))},R=()=>{r.current&&cancelAnimationFrame(r.current),a.current&&clearTimeout(a.current),c.current=null};return u(()=>{if(e&&b&&p>=e){y.current+=e*1e3;let n=y.current/1e3,{shouldRepeat:l=!1,delay:d=0,newStartAt:E}=b(n)||{};l&&s.current&&(a.current=setTimeout(()=>{T(E)},d*1e3))}},[p,e]),u(()=>(m&&(r.current=requestAnimationFrame(o)),R),[m]),u(()=>{m&&s.current&&(R(),r.current=requestAnimationFrame(o))},[e]),u(()=>{s.current&&T()},[S]),u(()=>{m&&f.current&&(R(),r.current=requestAnimationFrame(o)),f.current=!1},[F.current]),u(()=>(s.current=!0,()=>{s.current=!1}),[]),{elapsedTime:p,reset:T}};export{C as useElapsedTime};
